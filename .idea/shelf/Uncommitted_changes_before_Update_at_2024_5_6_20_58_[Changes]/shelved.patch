Index: bin/assiant/Macro/.idea/misc.xml
===================================================================
diff --git a/bin/assiant/Macro/.idea/misc.xml b/bin/assiant/Macro/.idea/misc.xml
deleted file mode 100644
--- a/bin/assiant/Macro/.idea/misc.xml	(revision 7030c7ed4f1c896cb1226650b4a372b170bdce69)
+++ /dev/null	(revision 7030c7ed4f1c896cb1226650b4a372b170bdce69)
@@ -1,13 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<project version="4">
-  <component name="ASMIdeaPluginConfiguration">
-    <asm skipDebug="true" skipFrames="false" skipCode="false" expandFrames="false" />
-    <groovy codeStyle="LEGACY" />
-  </component>
-  <component name="ProjectRootManager" version="2" languageLevel="JDK_21" default="true" project-jdk-name="21" project-jdk-type="JavaSDK">
-    <output url="file://$PROJECT_DIR$/out" />
-  </component>
-  <component name="ProjectType">
-    <option name="id" value="jpab" />
-  </component>
-</project>
\ No newline at end of file
Index: bin/assiant/Macro/.idea/Macro.iml
===================================================================
diff --git a/bin/assiant/Macro/.idea/Macro.iml b/bin/assiant/Macro/.idea/Macro.iml
deleted file mode 100644
--- a/bin/assiant/Macro/.idea/Macro.iml	(revision 7030c7ed4f1c896cb1226650b4a372b170bdce69)
+++ /dev/null	(revision 7030c7ed4f1c896cb1226650b4a372b170bdce69)
@@ -1,9 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<module type="JAVA_MODULE" version="4">
-  <component name="NewModuleRootManager" inherit-compiler-output="true">
-    <exclude-output />
-    <content url="file://$MODULE_DIR$" />
-    <orderEntry type="inheritedJdk" />
-    <orderEntry type="sourceFolder" forTests="false" />
-  </component>
-</module>
\ No newline at end of file
Index: bin/assiant/Macro/.idea/jpa-buddy.xml
===================================================================
diff --git a/bin/assiant/Macro/.idea/jpa-buddy.xml b/bin/assiant/Macro/.idea/jpa-buddy.xml
deleted file mode 100644
--- a/bin/assiant/Macro/.idea/jpa-buddy.xml	(revision 7030c7ed4f1c896cb1226650b4a372b170bdce69)
+++ /dev/null	(revision 7030c7ed4f1c896cb1226650b4a372b170bdce69)
@@ -1,6 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<project version="4">
-  <component name="JpaBuddyIdeaProjectConfig">
-    <option name="renamerInitialized" value="true" />
-  </component>
-</project>
\ No newline at end of file
Index: bin/assiant/Macro/.idea/encodings.xml
===================================================================
diff --git a/bin/assiant/Macro/.idea/encodings.xml b/bin/assiant/Macro/.idea/encodings.xml
deleted file mode 100644
--- a/bin/assiant/Macro/.idea/encodings.xml	(revision 7030c7ed4f1c896cb1226650b4a372b170bdce69)
+++ /dev/null	(revision 7030c7ed4f1c896cb1226650b4a372b170bdce69)
@@ -1,6 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<project version="4">
-  <component name="Encoding" defaultCharsetForPropertiesFiles="GBK">
-    <file url="PROJECT" charset="GBK" />
-  </component>
-</project>
\ No newline at end of file
Index: bin/assiant/Macro/.idea/vcs.xml
===================================================================
diff --git a/bin/assiant/Macro/.idea/vcs.xml b/bin/assiant/Macro/.idea/vcs.xml
deleted file mode 100644
--- a/bin/assiant/Macro/.idea/vcs.xml	(revision 7030c7ed4f1c896cb1226650b4a372b170bdce69)
+++ /dev/null	(revision 7030c7ed4f1c896cb1226650b4a372b170bdce69)
@@ -1,6 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<project version="4">
-  <component name="VcsDirectoryMappings">
-    <mapping directory="$PROJECT_DIR$" vcs="Git" />
-  </component>
-</project>
\ No newline at end of file
Index: bin/assiant/Macro/.idea/modules.xml
===================================================================
diff --git a/bin/assiant/Macro/.idea/modules.xml b/bin/assiant/Macro/.idea/modules.xml
deleted file mode 100644
--- a/bin/assiant/Macro/.idea/modules.xml	(revision 7030c7ed4f1c896cb1226650b4a372b170bdce69)
+++ /dev/null	(revision 7030c7ed4f1c896cb1226650b4a372b170bdce69)
@@ -1,8 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<project version="4">
-  <component name="ProjectModuleManager">
-    <modules>
-      <module fileurl="file://$PROJECT_DIR$/.idea/Macro.iml" filepath="$PROJECT_DIR$/.idea/Macro.iml" />
-    </modules>
-  </component>
-</project>
\ No newline at end of file
Index: bin/assiant/Macro/.idea/.gitignore
===================================================================
diff --git a/bin/assiant/Macro/.idea/.gitignore b/bin/assiant/Macro/.idea/.gitignore
deleted file mode 100644
--- a/bin/assiant/Macro/.idea/.gitignore	(revision 7030c7ed4f1c896cb1226650b4a372b170bdce69)
+++ /dev/null	(revision 7030c7ed4f1c896cb1226650b4a372b170bdce69)
@@ -1,8 +0,0 @@
-# Default ignored files
-/shelf/
-/workspace.xml
-# Editor-based HTTP Client requests
-/httpRequests/
-# Datasource local storage ignored files
-/dataSources/
-/dataSources.local.xml
Index: bin/assiant/Macro/天策/傲血_PVE_万灵当歌.lua
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>--[[ 奇穴: [扬戈][神勇][大漠][击水 or 龙驭][驰骋][牧云][风虎][战心][渊][夜征][龙血][虎贲]\r\n秘籍:\r\n穿云  1调息 1会心 2伤害\r\n龙吟  1调息 3伤害\r\n龙牙  1会心 3伤害\r\n突    1消耗 1距离 2伤害\r\n灭    1调息 1会心 2伤害\r\n战八方 1目标个数 1范围 2伤害\r\n断魂刺 2调息 2伤害\r\n\r\n如果点了[龙驭], 上马之后龙驭不到3层就动起来, 到3层站桩打\r\n--]]\r\n\r\n--宏选项\r\naddopt(\"乘龙箭打断\", false)\r\naddopt(\"副本防开怪\", false)\r\n\r\n--变量表\r\nlocal v = {}\r\nv[\"战意\"] = rage()\r\n\r\n--主循环\r\nfunction Main(g_player)\r\n\t-- 按下自定义快捷键1交扶摇\r\n\tif keydown(1) and scdtime(\"扶摇直上\") <= 0 then\r\n\t\tif cast(\"扶摇直上\") then\r\n\t\t\tsettimer(\"扶摇直上\")\r\n\t\tend\r\n\t\tif buff(\"骑御\") then\r\n\t\t\tcbuff(\"骑御\")\r\n\t\tend\r\n\tend\r\n\t\r\n\t--减伤\r\n\tif fight() then\r\n\t\tcast(\"啸如虎\")\r\n\r\n\t\tif life() < 0.55 then\r\n\t\t\tcast(\"守如山\")\r\n\t\tend\r\n\tend\r\n\r\n\t--目标不是敌对, 结束\r\n\tif not rela(\"敌对\") then return end\r\n\tif gettimer(\"冲刺\") < 0.3 then return end\r\n\t\r\n\tif getopt(\"副本防开怪\") and dungeon() and nofight() then \r\n\t\treturn\r\n\tend\r\n\r\n\t--等待任驰骋释放\r\n\tif casting(\"任驰骋\") and castleft() < 0.13 then\r\n\t\tsettimer(\"任驰骋读条结束\")\r\n\tend\r\n\tif gettimer(\"任驰骋读条结束\") < 0.3 then return end\r\n\t\r\n\r\n\t--初始化变量\r\n\t--v[\"目标流血时间\"] = tbufftime(\"流血\", id())\r\n\t--v[\"龙驭层数\"] = buffsn(\"龙驭\")\r\n\t--v[\"驰骋\"] = bufftime(\"驰骋\")\r\n\t--v[\"牧云\"] = bufftime(\"牧云\")\r\n\t--v[\"渊\"] = bufftime(\"2778\")\r\n\t--v[\"在马上\"] = buff(\"骑御\")\r\n\t--v[\"有队伍\"] = g_player.IsInParty()\r\n\r\n\t--下马\r\n\tif buff(\"骑御\") and nobuff(\"驰骋\") and cn(\"任驰骋\") > 0 and qixue(\"龙驭\") then\r\n\t\t--if cdleft(16) >= 1 and v[\"战意\"] < 5 and scdtime(\"撼如雷\") < 1.5 then\r\n\t\tif scdtime(\"撼如雷\") < 1 then\r\n\t\t\tcbuff(\"骑御\")\r\n\t\t\tsettimer(\"冲刺\") exit()\r\n\t\tend\r\n\tend\r\n\t\r\n\tif buff(\"骑御\") and (cn(\"任驰骋\") > 0 or (nobuff(\"牧云\") and scdtime(\"突\") <= 0) or scdtime(\"渊\") <= 1.5) and not qixue(\"龙驭\") then\r\n\t\tcbuff(\"骑御\")\r\n\t\tsettimer(\"冲刺\") exit()\r\n\tend\r\n\r\n\t--渊\r\n\tv[\"目标附近队友\"] = tparty(\"没状态:重伤\", \"不是自己\", \"自己距离>6\", \"自己距离<20\", \"距离<25\",\"不是内功:洗髓经|铁牢律|明尊琉璃体|铁骨衣\", \"视线可达\", \"距离最近\")\r\n\tif v[\"目标附近队友\"] ~= 0 and nobuff(\"骑御\") and qixue(\"渊\") and scdtime(\"渊\") <= 0 then\r\n\t\tif xcast(\"渊\", v[\"目标附近队友\"]) then\r\n\t\t\tsettimer(\"冲刺\") exit()\r\n\t\tend\r\n\t\treturn\r\n\tend\r\n\r\n\t--突\r\n\t--if cdleft(16) > 0.5 or nobuff(\"牧云\") then\r\n\tif cast(\"突\") then\r\n\t\tsettimer(\"冲刺\") exit()\r\n\tend\r\n\r\n\t--撼如雷\r\n\tif rela(\"敌对\") and dis() < 8 and cdleft(16) < 0.5 then\r\n\t\tif qixue(\"龙驭\") then\r\n\t\t\tif bufftime(\"驰骋\") > 9 then\r\n\t\t\t\tcast(\"撼如雷\", true)\r\n\t\t\tend\r\n\t\telseif bufftime(\"渊\") > 6 then\r\n\t\t\tcast(\"撼如雷\", true)\r\n\t\telseif bufftime(\"驰骋\") > 9 then\r\n\t\t\tcast(\"撼如雷\", true)\r\n\t\tend\r\n\tend\r\n\r\n\t--断魂刺\r\n\tif v[\"战意\"] <= 2 or dis() > 8 then\r\n\t\tif cast(\"断魂刺\") then\r\n\t\t\tsettimer(\"冲刺\") exit()\r\n\t\tend\r\n\tend\r\n\r\n\t---------------------------------------------\r\n\r\n\tif getopt(\"乘龙箭打断\") and tbuffstate(\"可打断\") then\r\n\t\tcast(\"乘龙箭\")\r\n\tend\r\n\r\n\t--任驰骋\r\n\tif qixue(\"龙驭\") then\r\n\t\tif buff(\"牧云\") then\r\n\t\t\tcast(\"任驰骋\")\r\n\t\tend\r\n\tend\r\n\t\r\n\tif not qixue(\"龙驭\")and nobuff(\"驰骋\") then\r\n\t\tif buff(\"牧云\") then\r\n\t\t\tcast(\"任驰骋\")\r\n\t\tend\r\n\tend\r\n\r\n\t--保流血\r\n\tif tbufftime(\"流血\", id()) < cdinterval(16) * 2 then\r\n\t\tif v[\"战意\"] <= 2 then\r\n\t\t\tcast(\"灭\")\r\n\t\tend\r\n\t\tcast(\"龙吟\")\r\n\t\tcast(\"灭\")\r\n\tend\r\n\r\n\t--龙牙\r\n\tif v[\"战意\"] >= 5 then\r\n\t\tcast(\"龙牙\")\r\n\tend\r\n\r\n\t--战八方\r\n\t_, v[\"6尺内敌人数量\"] = npc(\"关系:敌对\", \"距离<6\", \"可选中\")\r\n\tif v[\"6尺内敌人数量\"] >= 3 then\r\n\t\tcast(\"战八方\")\r\n\tend\r\n\r\n\t--灭\r\n\tif v[\"战意\"] <= 2 then\r\n\t\tcast(\"灭\")\r\n\tend\r\n\r\n\t--龙吟\r\n\tif v[\"战意\"] <= 3 then\r\n\t\tcast(\"龙吟\")\r\n\tend\r\n\r\n\t--穿云\r\n\tcast(\"穿云\")\r\nend\r\n\r\n--释放技能\r\nfunction OnCast(CasterID, SkillName, SkillID, SkillLevel, TargetType, TargetID, PosY, PosZ, StartFrame, FrameCount)\r\n\tif CasterID == id() then\r\n\t\tif SkillID == 428  then\t--断魂刺\r\n\t\t\tv[\"战意\"] = v[\"战意\"] + 3\r\n\t\tend\r\n\t\tif SkillID == 433 then\t--任驰骋\r\n\t\t\tdeltimer(\"任驰骋读条结束\")\r\n\t\tend\r\n\tend\r\nend\r\n\r\n--状态更新\r\nfunction OnStateUpdate(nCurrentLife, nCurrentMana, nCurrentRage, nCurrentEnergy, nCurrentSunEnergy, nCurrentMoonEnergy)\r\n\t--print(\"OnStateUpdate, 战意: \"..nCurrentRage)\r\n\tv[\"战意\"] = nCurrentRage\r\nend\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>GBK
===================================================================
diff --git a/bin/assiant/Macro/天策/傲血_PVE_万灵当歌.lua b/bin/assiant/Macro/天策/傲血_PVE_万灵当歌.lua
--- a/bin/assiant/Macro/天策/傲血_PVE_万灵当歌.lua	(revision 7030c7ed4f1c896cb1226650b4a372b170bdce69)
+++ b/bin/assiant/Macro/天策/傲血_PVE_万灵当歌.lua	(date 1710350828000)
@@ -64,6 +64,7 @@
 	--v["在马上"] = buff("骑御")
 	--v["有队伍"] = g_player.IsInParty()
 
+	cast("撼如雷")
 	--下马
 	if buff("骑御") and nobuff("驰骋") and cn("任驰骋") > 0 and qixue("龙驭") then
 		--if cdleft(16) >= 1 and v["战意"] < 5 and scdtime("撼如雷") < 1.5 then
Index: bin/assiant/Macro/通用/Test.lua
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>---\r\n--- Generated by EmmyLua(https://github.com/EmmyLua)\r\n--- Created by Gin.\r\n--- DateTime: 2024/2/2 0:49\r\n---\r\n\r\nlocal ok = false\r\n\r\nfunction Main()\r\n    local me = self()\r\n    for i, v in pairs(me) do\r\n        print(i,v)\r\n    end\r\nend
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>GBK
===================================================================
diff --git a/bin/assiant/Macro/通用/Test.lua b/bin/assiant/Macro/通用/Test.lua
--- a/bin/assiant/Macro/通用/Test.lua	(revision 7030c7ed4f1c896cb1226650b4a372b170bdce69)
+++ b/bin/assiant/Macro/通用/Test.lua	(date 1710619226000)
@@ -7,8 +7,75 @@
 local ok = false
 
 function Main()
-    local me = self()
-    for i, v in pairs(me) do
-        print(i,v)
+    --local me = self()
+    --for i, v in pairs(me) do
+    --    print(i,v)
+    --end
+    --cast("后撤")
+    --print(endurance(tid()))
+    turn()
+    stopmove()
+    if nobuff("生太极") then
+        cast("生太极", true)
+    end
+
+    if nobuff("吞日月") then
+        cast("吞日月", true)
+    end
+    if nobuff("碎星辰") then
+        cast("碎星辰")
+    end
+
+    if buff("碎星辰") or buff("吞日月") then
+        cast("人剑合一")
     end
+
+    if dis() < 20 and  dis() > 8 then
+        cast("生太极")
+        cast("吞日月")
+        cast("碎星辰")
+    end
+
+    if dis() > 18 and face() < 10 then
+        acast("蹑云逐月")
+        cast("剑冲阴阳")
+    end
+
+
+    if tface() < 90 or dis() > 4 then
+        local x,y,z = xpos(tid())
+        local x_,y_,z_ = pos()
+        local big = ture
+        if( x - x_) > 0 then
+            big = false
+        end
+        if big then
+            moveto(x + 4, y , z);
+        else
+            moveto(x - 4, y , z);
+        end
+    end
+
+    if(tbuffstate("可打断")) then
+        acast("剑飞惊天")
+    end
+
+    if qidian() > 8 and tbuffstate("可定身") then
+        cast("大道无术")
+    end
+
+    if qidian() > 7 then
+        acast("无我无剑")
+    end
+
+    if tlife() < 40 then
+        acast("八荒归元")
+    end
+
+    if dis() < 6 then
+        acast("万剑归宗")
+    end
+
+    acast("三环套月")
+
 end
\ No newline at end of file
Index: bin/assiant/Macro/万灵/PVP_万灵 _JJC.lua
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>--[[ 奇穴: [素矰][棘矢][襄尺][长右][鹿蜀][桑柘][于狩][卢令][托月][佩弦][贯侯][朝仪万汇]\r\n秘籍:\r\n劲风\t2会心 2伤害\r\n饮羽\t2调息 1重置 1非侠\r\n引风\t3调息 1回血\r\n\r\n开打前把蓝打坐回满, 不然起手弛律不会放, 引风的释放时机有点问题导致有的大循环少1次棘矢引爆, 怕循环卡的太死实战中少打引风蓝不够\r\n--]]\r\n\r\nload(\"Macro/Lib_PVP.lua\")\r\n\r\n--关闭自动面向\r\nsetglobal(\"自动面向\", false)\r\n\r\n--宏选项\r\naddopt(\"副本防开怪\", false)\r\n\r\n--变量表\r\nlocal v = {}\r\nv[\"输出信息\"] = true\r\nv[\"没石次数\"] = 0\r\n\r\n--函数表\r\nlocal f = {}\r\n\r\n--主循环\r\nfunction Main()\r\n    cast(\"风失\")\r\n    if casting(\"饮羽簇\") and castleft() < 0.13 then\r\n        settimer(\"饮羽簇读条结束\")\r\n    end\r\n    if gettimer(\"饮羽簇读条结束\") < 0.3 then\r\n        return\r\n    end\r\n\r\n    --应天授命\r\n    if fight() and life() < 0.20 then\r\n        CastX(\"应天授命\")\r\n    end\r\n\r\n    --初始化变量\r\n    v[\"弓箭\"] = rage()\r\n    v[\"幻灵印\"] = beast()\r\n\r\n    v[\"饮羽CD\"] = scdtime(\"饮羽簇\")\r\n    v[\"白羽CD\"] = scdtime(\"白羽流星\")\r\n    v[\"金乌充能次数\"] = cn(\"金乌见坠\")\r\n    v[\"金乌充能时间\"] = cntime(\"金乌见坠\", true)\r\n    v[\"引风CD\"] = scdtime(\"引风唤灵\")\r\n    v[\"弛律CD\"] = scdtime(\"弛律召野\")\r\n    v[\"朝仪CD\"] = scdtime(\"朝仪万汇\")\r\n\r\n    v[\"承契层数\"] = buffsn(\"承契\")\r\n    v[\"承契时间\"] = bufftime(\"承契\")\r\n    v[\"贯穿层数\"] = tbuffsn(\"贯穿\", id())\r\n    v[\"贯穿时间\"] = tbufftime(\"贯穿\", id())\r\n    v[\"标鹄层数\"] = tbuffsn(\"标鹄\")\r\n    v[\"标鹄时间\"] = tbufftime(\"标鹄\", id())\r\n    v[\"目标血量较多\"] = rela(\"敌对\") and tlifevalue() > lifemax() * 10\r\n\r\n    --if keydown(\"ACTIONBAR2_BUTTON10\") then\r\n    --    cast(\"游雾乘云\")\r\n    --end\r\n    --\r\n    --if keydown(\"1\") then\r\n    --    cast(\"游雾乘云\")\r\n    --end\r\n    if qixue(\"星烨\") and fight() then\r\n        if v[\"幻灵印\"] == 0 then\r\n            if not nextbeast(\"野猪\") then\r\n                --只召鹰\r\n                setbeast({\"野猪\", \"虎\", \"熊\", \"鹰\", \"狼\", \"大象\" })\r\n            end\r\n        end\r\n\r\n        if v[\"幻灵印\"] == 1 then\r\n            if not nextbeast(\"虎\") then\r\n                --只召鹰\r\n                setbeast({  \"虎\",\"野猪\",\"鹰\", \"熊\", \"狼\", \"大象\"})\r\n            end\r\n\r\n            if v[\"幻灵印\"] == 1 and scdtime(\"引风唤灵\") > 2 then\r\n                CastX(\"弛律召野\")\r\n            end\r\n        end\r\n\r\n        if v[\"幻灵印\"] >= 2 and dis() > 0 and dis() < 30 then\r\n            CastX(\"游雾乘云\")\r\n        end\r\n    end\r\n\r\n    --if qixue(\"星烨\") and fight() then\r\n    --    if v[\"幻灵印\"] == 1 and scdtime(\"引风唤灵\") > 2 then\r\n    --        CastX(\"弛律召野\")\r\n    --    end\r\n    --\r\n    --    if v[\"幻灵印\"] >= 2 and dis() > 0 and dis() < 30 then\r\n    --        CastX(\"游雾乘云\")\r\n    --    end\r\n    --end\r\n\r\n    if fight() and rela(\"敌对\") then\r\n        CastX(\"引风唤灵\")\r\n    end\r\n\r\n\r\n    if buff(\"游雾乘云\") then\r\n        CastX(\"弛风鸣角\")\r\n    end\r\n    --设置动物\r\n    --if not nextbeast(\"鹰\") then\t\t--只召鹰\r\n    --    setbeast( { \"鹰\", \"虎\", \"狼\", \"大象\", \"野猪\", \"熊\" } )\r\n    --end\r\n\r\n    --澄神醒梦\r\n    --v[\"被控时间\"] = math.max(buffstate(\"定身时间\"), buffstate(\"眩晕时间\"), buffstate(\"击倒时间\"))\r\n    --if v[\"被控时间\"] - cdleft(16) > 1 then\r\n    --    CastX(\"澄神醒梦\")\r\n    --end\r\n\r\n    if v[\"弓箭\"] >= 5 then\r\n        v[\"最后一支箭状态\"] = arrow(0)\r\n        if v[\"最后一支箭状态\"] ~= 3 and v[\"最后一支箭状态\"] ~= 4 then\r\n            if v[\"幻灵印\"] ~= 1 then\r\n                --最后一支箭没金乌\r\n                CastX(\"空弦惊雁\")\r\n            end\r\n        end\r\n    end\r\n\r\n    --寒更晓箭\r\n    if v[\"弓箭\"] < 8 then\r\n        if nofight() then\r\n            --没进战把箭装满\r\n            CastX(\"寒更晓箭\")\r\n        end\r\n\r\n        if v[\"弓箭\"] < 1 then\r\n            --没箭了装箭, 自动装箭会比GCD晚1帧, 自己装, 抢不过也没影响, 抢过了还能快1帧\r\n            CastX(\"寒更晓箭\")\r\n        end\r\n    end\r\n\r\n    --副本防开怪\r\n    if getopt(\"副本防开怪\") and dungeon() and nofight() then\r\n        return\r\n    end\r\n\r\n    -- CastX(\"流失雨集\")\r\n    -- if v[\"弓箭\"] >= 8 then\r\n    --     --满箭才用\r\n    --     if rela(\"敌对\") and dis() < 30 then\r\n    --         v[\"最后一支箭状态\"] = arrow(0)\r\n    --         if v[\"最后一支箭状态\"] ~= 2 and v[\"最后一支箭状态\"] ~= 4 then\r\n    --             --最后一支箭没金乌\r\n    --             CastX(\"霖集簇\")\r\n    --         end\r\n    --     end\r\n    -- end\r\n\r\n    --金乌见坠\r\n    if v[\"弓箭\"] >= 8 then\r\n        --满箭才用\r\n        if rela(\"敌对\") and dis() < 30 then\r\n            v[\"最后一支箭状态\"] = arrow(0)\r\n            if v[\"最后一支箭状态\"] ~= 2 and v[\"最后一支箭状态\"] ~= 4 then\r\n                --最后一支箭没金乌\r\n                if v[\"幻灵印\"] ~= 1 or v[\"金乌充能次数\"] >= 2 then\r\n                    CastX(\"金乌见坠\")\r\n                end\r\n            end\r\n\r\n            if v[\"金乌充能次数\"] >= 3 and bufftime(\"佩弦\") < 0 and v[\"饮羽CD\"] < 1 then\r\n                --充能满了没瞬发\r\n                CastX(\"金乌见坠\")\r\n            end\r\n        end\r\n    end\r\n\r\n    --没石饮羽\r\n    if buff(\"26862\") then\r\n        CastX(\"没石饮羽\")\r\n    end\r\n\r\n    --棘矢处理\r\n    if qixue(\"棘矢\") then\r\n        if gettimer(\"释放没石饮羽\") < 2 and v[\"弓箭\"] == 2 then\r\n            --没石后把箭打到1\r\n            CastX(\"劲风簇\")\r\n        end\r\n    end\r\n\r\n    --饮羽簇\r\n    if v[\"弓箭\"] >= 8 and v[\"承契时间\"] < 2.5 then\r\n        --起手打承契\r\n        CastX(\"饮羽簇\")\r\n    end\r\n    if v[\"弓箭\"] == 5 or v[\"弓箭\"] == 6 then\r\n        --循环内\r\n        CastX(\"饮羽簇\")\r\n    end\r\n\r\n    --弛风鸣角\r\n    if buff(\"26861\") and v[\"弓箭\"] >= 3 then\r\n        if v[\"弓箭\"] == 3 then\r\n            --最后3箭\r\n            CastX(\"弛风鸣角\")\r\n        end\r\n\r\n        if v[\"弓箭\"] == 8 and v[\"引风CD\"] < 4.5 and v[\"饮羽CD\"] < cdinterval(16) then\r\n            --这个小节打引风\r\n            CastX(\"弛风鸣角\")\r\n        end\r\n    end\r\n\r\n    --引风唤灵, 和目标的角色距离大于20尺是在自己附近放\r\n    if fight() and rela(\"敌对\") and dis3() < 20 then\r\n        CastX(\"引风唤灵\")\r\n    end\r\n\r\n    --弛律召野\r\n    if fight() and rela(\"敌对\") and dis3() < 20 then\r\n        if v[\"承契层数\"] < 5 and mana() > 0.8 then\r\n            --起手打承契\r\n            CastX(\"弛律召野\")\r\n        end\r\n    end\r\n\r\n    --朝仪万汇\r\n    --if v[\"目标血量较多\"] and v[\"承契时间\"] > 12 and v[\"弓箭\"] < 5 then\r\n    --    if gettimer(\"释放寒更晓箭\") < 0.5 or v[\"弓箭\"] > 0 then\r\n    --        --GCD刚转完, 放朝仪开始引导, 自动的寒更晓箭放不出来\r\n    --        if v[\"弓箭\"] ~= 1 or gettimer(\"释放没石饮羽\") > 2.5 or v[\"没石次数\"] >= 3 then\r\n    --            --防止卡掉没石后续2跳\r\n    --            CastX(\"朝仪万汇\")\r\n    --        end\r\n    --    end\r\n    --end\r\n\r\n    --if v[\"\"]\r\n\r\n    --劲风簇\r\n    if qixue(\"棘矢\") and v[\"弓箭\"] == 1 then\r\n        --最后1支箭\r\n        if gettimer(\"释放没石饮羽\") > 1.75 or v[\"没石次数\"] >= 2 then\r\n            --没石2跳之后\r\n            CastX(\"劲风簇\")\r\n        end\r\n    else\r\n        CastX(\"劲风簇\")\r\n    end\r\n\r\n    -- if nofight() then\r\n    --     g_func[\"采集\"]()\r\n    -- end\r\n    --[[\r\n    if fight() and rela(\"敌对\") and dis() < 25 and cdleft(16) <= 0 and castleft() <= 0 and gettimer(\"朝仪万汇\") > 0.5 and gettimer(\"弛风鸣角\") > 0.5 then\r\n        PrintInfo(\"---------- 没打技能\")\r\n    end\r\n    --]]\r\nend\r\n\r\n-------------------------------------------------------------------------------\r\n\r\n--输出信息\r\nfunction PrintInfo(s)\r\n    local t = {}\r\n    if s then\r\n        t[#t + 1] = s\r\n    end\r\n    t[#t + 1] = \"弓箭:\" .. v[\"弓箭\"]\r\n    t[#t + 1] = \"内力:\" .. mana()\r\n    --t[#t+1] = \"幻灵印:\"..v[\"幻灵印\"]\r\n\r\n    t[#t + 1] = \"承契:\" .. v[\"承契层数\"] .. \", \" .. v[\"承契时间\"]\r\n    t[#t + 1] = \"贯穿:\" .. v[\"贯穿层数\"] .. \", \" .. v[\"贯穿时间\"]\r\n    t[#t + 1] = \"标鹄:\" .. v[\"标鹄层数\"] .. \", \" .. v[\"标鹄时间\"]\r\n\r\n    t[#t + 1] = \"饮羽CD:\" .. v[\"饮羽CD\"]\r\n    t[#t + 1] = \"白羽CD:\" .. v[\"白羽CD\"]\r\n    t[#t + 1] = \"引风CD:\" .. v[\"引风CD\"]\r\n    --t[#t+1] = \"弛律CD:\"..v[\"弛律CD\"]\r\n    t[#t + 1] = \"朝仪CD:\" .. v[\"朝仪CD\"]\r\n    t[#t + 1] = \"金乌CD:\" .. v[\"金乌充能次数\"] .. \", \" .. v[\"金乌充能时间\"]\r\n\r\n    print(table.concat(t, \", \"))\r\nend\r\n\r\n--使用技能并输出信息\r\nfunction CastX(szSkill, bSelf)\r\n    if cast(szSkill, bSelf) then\r\n        settimer(szSkill)\r\n        if v[\"输出信息\"] then\r\n            PrintInfo()\r\n        end\r\n        return true\r\n    end\r\n    return false\r\nend\r\n\r\n-------------------------------------------------------------------------------\r\n\r\n--释放技能\r\nfunction OnCast(CasterID, SkillName, SkillID, SkillLevel, TargetType, TargetID, PosY, PosZ, StartFrame, FrameCount)\r\n    if CasterID == id() then\r\n        if SkillID == 35665 then\r\n            --没石饮羽\r\n            v[\"没石次数\"] = 0\r\n            settimer(\"释放没石饮羽\")\r\n        end\r\n\r\n        if SkillID == 35987 then\r\n            --没石每跳子技能\r\n            v[\"没石次数\"] = v[\"没石次数\"] + 1\r\n        end\r\n\r\n        if SkillID == 36165 then\r\n            print(\"----------棘矢引爆\")\r\n        end\r\n\r\n        if SkillID == 35695 then\r\n            --引风唤灵\r\n            settimer(\"释放引风唤灵\")\r\n        end\r\n\r\n        if SkillID == 35669 then\r\n            --寒更晓箭\r\n            settimer(\"释放寒更晓箭\")\r\n            print(\"----------------------------------------寒更晓箭换箭\")\r\n        end\r\n\r\n        if SkillID == 35661 then\r\n            --饮羽簇\r\n            deltimer(\"饮羽簇读条结束\")\r\n        end\r\n    end\r\nend\r\n\r\n--战斗状态改变, 日志记录一下用于分析数据\r\nfunction OnFight(bFight)\r\n    if bFight then\r\n        print(\"--------------------进入战斗\")\r\n    else\r\n        print(\"--------------------离开战斗\")\r\n    end\r\nend\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>GBK
===================================================================
diff --git a/bin/assiant/Macro/万灵/PVP_万灵 _JJC.lua b/bin/assiant/Macro/万灵/PVP_万灵 _JJC.lua
--- a/bin/assiant/Macro/万灵/PVP_万灵 _JJC.lua	(revision 7030c7ed4f1c896cb1226650b4a372b170bdce69)
+++ b/bin/assiant/Macro/万灵/PVP_万灵 _JJC.lua	(date 1710683340000)
@@ -25,7 +25,8 @@
 
 --主循环
 function Main()
-    cast("风失")
+    --cast("风失")
+    cast(35894)
     if casting("饮羽簇") and castleft() < 0.13 then
         settimer("饮羽簇读条结束")
     end
@@ -35,7 +36,7 @@
 
     --应天授命
     if fight() and life() < 0.20 then
-        CastX("应天授命")
+        cast("应天授命")
     end
 
     --初始化变量
@@ -58,25 +59,114 @@
     v["标鹄时间"] = tbufftime("标鹄", id())
     v["目标血量较多"] = rela("敌对") and tlifevalue() > lifemax() * 10
 
+    --寒更晓箭
+    if v["弓箭"] < 8 then
+        if nofight() then
+            --没进战把箭装满
+            CastX("寒更晓箭")
+        end
+
+        if v["弓箭"] < 1 then
+            --没箭了装箭, 自动装箭会比GCD晚1帧, 自己装, 抢不过也没影响, 抢过了还能快1帧
+            CastX("寒更晓箭")
+        end
+    end
+
+    if v["弓箭"] >= 5 then
+        v["最后一支箭状态"] = arrow(0)
+        if v["最后一支箭状态"] ~= 3 and v["最后一支箭状态"] ~= 4 then
+            if v["幻灵印"] ~= 1 then
+                --最后一支箭没金乌
+                CastX("空弦惊雁")
+            end
+        end
+    end
+
     --if keydown("ACTIONBAR2_BUTTON10") then
-    --    cast("游雾乘云")
+    --    CastX("游雾乘云")
     --end
     --
     --if keydown("1") then
-    --    cast("游雾乘云")
+    --    CastX("游雾乘云")
     --end
+    --if qixue("蓄锐") and qixue("桑枳") then
+    --
+    --end
+
+    if qixue("朱厌") or qixue("祝灵") and fight() then
+        if qixue("兴游") and v["幻灵印"] >= 3 then
+            if v["弓箭"] < 8 then
+                CastX("寒更晓箭")
+            end
+            CastX("汇灵合契")
+        end
+        if v["幻灵印"] >= 4 then
+            if v["弓箭"] < 8 then
+                CastX("寒更晓箭")
+            end
+            CastX("汇灵合契")
+        end
+
+        if buff("汇灵合契") then
+            if v["弓箭"] < 8 then
+                --cast("白羽流星")
+                cast(35974)
+            end
+            if dis() < 10 then
+                if scdtime("聚长川") == 0 then
+                    print(scdtime("聚长川"))
+                    CastX("聚长川")
+                end
+                if scdtime("汇山岚") == 0 then
+                    print(scdtime("汇山岚"))
+                    CastX("汇山岚")
+                end
+            end
+
+            CastX(35688)
+
+            --if v["弓箭"] < 8 then
+            --    --cast("白羽流星")
+            --    cast(35974)
+            --end
+            print("--------------")
+            return
+        end
+
+        if not qixue("兴游") then
+            if v["幻灵印"] == 1 then
+                --cast("弛律召野")
+                CastX(35696)
+            end
+        else
+            if v["幻灵印"] == 0 then
+                CastX(35696)
+            end
+        end
+    end
+
+    --引风唤灵, 和目标的角色距离大于20尺是在自己附近放
+    if fight() and rela("敌对") and dis3() < 20 then
+        CastX("引风唤灵")
+    end
+
+
     if qixue("星烨") and fight() then
         if v["幻灵印"] == 0 then
             if not nextbeast("野猪") then
                 --只召鹰
-                setbeast({"野猪", "虎", "熊", "鹰", "狼", "大象" })
+                setbeast({ "野猪", "虎", "熊", "鹰", "狼", "大象" })
             end
+
+            if scdtime("引风唤灵") < 5 then
+                CastX("弛律召野")
+            end
         end
 
         if v["幻灵印"] == 1 then
             if not nextbeast("虎") then
                 --只召鹰
-                setbeast({  "虎","野猪","鹰", "熊", "狼", "大象"})
+                setbeast({ "虎", "野猪", "鹰", "熊", "狼", "大象" })
             end
 
             if v["幻灵印"] == 1 and scdtime("引风唤灵") > 2 then
@@ -84,7 +174,7 @@
             end
         end
 
-        if v["幻灵印"] >= 2 and dis() > 0 and dis() < 30 then
+        if v["幻灵印"] >= 2 and dis() > 0 and dis() < 30 and bufftime("澄神") < 2 then
             CastX("游雾乘云")
         end
     end
@@ -103,8 +193,15 @@
         CastX("引风唤灵")
     end
 
-
     if buff("游雾乘云") then
+        --if v["弓箭"] <= 3 then
+        --    CastX("弛风鸣角")
+        --end
+
+        --if bufftime("游雾乘云") < 3 then
+        --    CastX("弛风鸣角")
+        --end
+
         CastX("弛风鸣角")
     end
     --设置动物
@@ -118,29 +215,6 @@
     --    CastX("澄神醒梦")
     --end
 
-    if v["弓箭"] >= 5 then
-        v["最后一支箭状态"] = arrow(0)
-        if v["最后一支箭状态"] ~= 3 and v["最后一支箭状态"] ~= 4 then
-            if v["幻灵印"] ~= 1 then
-                --最后一支箭没金乌
-                CastX("空弦惊雁")
-            end
-        end
-    end
-
-    --寒更晓箭
-    if v["弓箭"] < 8 then
-        if nofight() then
-            --没进战把箭装满
-            CastX("寒更晓箭")
-        end
-
-        if v["弓箭"] < 1 then
-            --没箭了装箭, 自动装箭会比GCD晚1帧, 自己装, 抢不过也没影响, 抢过了还能快1帧
-            CastX("寒更晓箭")
-        end
-    end
-
     --副本防开怪
     if getopt("副本防开怪") and dungeon() and nofight() then
         return
@@ -213,18 +287,13 @@
         end
     end
 
-    --引风唤灵, 和目标的角色距离大于20尺是在自己附近放
-    if fight() and rela("敌对") and dis3() < 20 then
-        CastX("引风唤灵")
-    end
-
     --弛律召野
-    if fight() and rela("敌对") and dis3() < 20 then
-        if v["承契层数"] < 5 and mana() > 0.8 then
-            --起手打承契
-            CastX("弛律召野")
-        end
-    end
+    --if fight() and rela("敌对") and dis3() < 20 then
+    --    if v["承契层数"] < 5 and mana() > 0.8 then
+    --        --起手打承契
+    --        CastX("弛律召野")
+    --    end
+    --end
 
     --朝仪万汇
     --if v["目标血量较多"] and v["承契时间"] > 12 and v["弓箭"] < 5 then
Index: bin/assiant/Macro/通用/日常.lua
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>\r\nload(\"Macro/Lib_Coordinates.lua\")\r\nload(\"Macro/Lib_Base.lua\")\r\n\r\nfunction Main()\r\n    --print(g_map_move.moveToNpc, g_map_move.currentStep, g_map_move.coordinateLength, g_map_move.currentMap, g_map_move.currentGoods)\r\n\r\n\r\n    local map = map();\r\n\r\n    if map == \"跨服·烂柯山\" or map == \"帮会领地\" or map == \"南屏山\" or map == \"昆仑\" or map == \"南屏山\" then\r\n        g_base[\"采集\"]()\r\n    end\r\n\r\n    if map == \"帮会领地\" then\r\n        g_base[\"杀猪\"]()\r\n    end\r\n\r\n    if map == \"马嵬驿\" or map == \"龙门荒漠\" or map == \"巴陵县\" or map == \"洛道\" then\r\n        g_map_move[\"移动\"]()\r\n    end\r\n\r\nend
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>GBK
===================================================================
diff --git a/bin/assiant/Macro/通用/日常.lua b/bin/assiant/Macro/通用/日常.lua
--- a/bin/assiant/Macro/通用/日常.lua	(revision 7030c7ed4f1c896cb1226650b4a372b170bdce69)
+++ b/bin/assiant/Macro/通用/日常.lua	(date 1710336458000)
@@ -5,19 +5,19 @@
 function Main()
     --print(g_map_move.moveToNpc, g_map_move.currentStep, g_map_move.coordinateLength, g_map_move.currentMap, g_map_move.currentGoods)
 
-
-    local map = map();
+    if nofight() then
+        local map = map();
 
-    if map == "跨服·烂柯山" or map == "帮会领地" or map == "南屏山" or map == "昆仑" or map == "南屏山" then
-        g_base["采集"]()
-    end
+        if map == "跨服·烂柯山" or map == "帮会领地" or map == "南屏山" or map == "昆仑" or map == "南屏山" then
+            g_base["采集"]()
+        end
 
-    if map == "帮会领地" then
-        g_base["杀猪"]()
-    end
+        if map == "帮会领地" then
+            g_base["杀猪"]()
+        end
 
-    if map == "马嵬驿" or map == "龙门荒漠" or map == "巴陵县" or map == "洛道" then
-        g_map_move["移动"]()
+        if map == "马嵬驿" or map == "龙门荒漠" or map == "巴陵县" or map == "洛道" then
+            g_map_move["移动"]()
+        end
     end
-
 end
\ No newline at end of file
Index: bin/assiant/Macro/万花/离经_ZC.lua
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>--[[ 奇穴: [弹指 或 竭泽][烟霞 或 生息][青律 或 月华 或 秋肃][清疏 或 厥阴指][微潮][积势][书离][渐催 或 池月][寒清 或 锋末][清神][遥归][落子无悔]\r\n秘籍:\r\n星楼  2调息 1消耗 1减伤\r\n提针  2读条 1疗效 1回墨意\r\n长针  1消耗 1距离 2疗效\r\n商阳  1距离 3消耗\r\n\r\n奇穴秘籍只是推荐，我也不太会玩，你是老手你自己看着点\r\n如果需要打断点[厥阴指], 开启宏选项中的打断\r\n没有特殊情况当前目标一直选中boss就行了\r\n--]]\r\n\r\n--宏选项\r\naddopt(\"打断\", false)\r\n\r\n--变量表\r\nlocal v = {}\r\nv[\"记录信息\"] = true\r\n\r\n--函数表\r\nlocal f = {}\r\n\r\n--主循环\r\nfunction Main()\r\n\t--按下自定义快捷键1挂扶摇, 注意是快捷键设定里面插件的快捷键1指定的按键，不是键盘上的1\r\n\tif keydown(1) then\r\n\t\tcast(\"扶摇直上\")\r\n\tend\r\n\r\n\t--减伤\r\n\tif fight() and life() < 0.5 then\r\n\t\tcast(\"星楼月影\")\r\n\tend\r\n\r\n\t--打断\r\n\tif getopt(\"打断\") and tbuffstate(\"可打断\") then\r\n\t\tcast(\"厥阴指\")\r\n\tend\r\n\r\n\t--初始化变量\r\n\tv[\"墨意\"] = rage()\r\n\tv[\"治疗量\"] = charinfo(\"治疗量\")\t--如果想精确治疗，治疗量 * 技能系数 = 技能实际加血量\r\n\tv[\"治疗目标\"] = f[\"获取治疗目标\"]()\r\n\tv[\"治疗目标血量\"] = xlife(v[\"治疗目标\"])\r\n\tv[\"治疗目标是T\"] = xmount(\"洗髓经|铁牢律|明尊琉璃体|铁骨衣\", v[\"治疗目标\"])\r\n\r\n\t---------------------------------------------\r\n\r\n\t--听风\r\n\tif fight() and v[\"治疗目标血量\"] < 0.4 and life() > 0.6  then\r\n\t\tCastX(\"听风吹雪\")\r\n\tend\r\n\r\n\t--长针\r\n\tif v[\"治疗目标血量\"] < 0.45 then\r\n\t\t--水月\r\n\t\tif fight() and v[\"墨意\"] < 20 then\r\n\t\t\tcast(\"水月无间\")\r\n\t\tend\r\n\r\n\t\tif buff(\"412|722|932|3458|6266\") then\t--有瞬发\r\n\t\t\tCastX(\"长针\")\r\n\t\tend\r\n\tend\r\n\r\n\t--彼针\r\n\r\n\t--提针\r\n\tif v[\"治疗目标血量\"] < 0.9 then\t\t--加血\r\n\t\tCastX(\"提针\")\r\n\tend\r\n\r\n\tif v[\"墨意\"] < 30 then\t\t\t\t--刷墨意\r\n\t\tCastX(\"提针\")\r\n\tend\r\n\r\n\t--握针\r\n\tif rela(\"敌对\") and ttid() ~= 0 and xrela(\"自己|友好|队友\", ttid()) then\t--目标的目标 boss的目标大概率就是下一个要奶的人\r\n\t\tif xbufftime(\"握针\", ttid(), id()) < 3 then\r\n\t\t\txcast(\"握针\", ttid())\r\n\t\tend\r\n\tend\r\n\r\n\t--碧水\r\n\tif fight() and mana() < 0.45 then\r\n\t\tcast(\"碧水滔天\", true)\r\n\tend\r\n\r\n\t--秋肃\r\n\tif fight() and target(\"boss\") and face() < 80 and qixue(\"秋肃\") and tbufftime(\"秋肃\") < 3 then\r\n\t\tcast(\"商阳指\")\r\n\tend\r\n\r\n\t-- 握针\r\n\txcast(\"握针\", party(\"没状态:重伤\", \"距离<20\",  \"视线可达\", \"我的buff时间:握针<3\"))\r\n\r\n\t--脱战救人\r\n\tif casting(\"锋针\") and castleft() < 0.13 then\r\n\t\tsettimer(\"锋针读条结束\")\r\n\tend\r\n\tif nofight() and gettimer(\"锋针读条结束\") > 0.5 then\r\n\t\txcast(\"锋针\", party(\"有状态:重伤\", \"距离<20\", \"视线可达\"))\r\n\tend\r\nend\r\n\r\n-------------------------------------------------------------------------------\r\n\r\nf[\"获取治疗目标\"] = function()\r\n\tlocal targetID = id()\t--治疗目标先设置为自己, 不在队伍或者团队中时 party 返回 0\r\n\tlocal partyID = party(\"没状态:重伤\", \"不是自己\", \"距离<20\", \"视线可达\", \"没载具\", \"气血最少\")\t--获取血量最少队友\r\n\tif partyID ~= 0 and partyID ~= targetID and xlife(partyID) < life() then\t--有血量最少队友且比自己血量少\r\n\t\ttargetID = partyID\t--把他指定为治疗目标\r\n\tend\r\n\treturn targetID\r\nend\r\n\r\n--记录信息\r\nfunction PrintInfo(s)\r\n\tlocal t = {}\r\n\tif s then t[#t+1] = s end\r\n\tt[#t+1] = \"墨意:\"..v[\"墨意\"]\r\n\tt[#t+1] = \"治疗目标:\"..v[\"治疗目标\"]\r\n\tt[#t+1] = \"治疗目标血量:\"..format(\"%0.2f\", v[\"治疗目标血量\"])\r\n\tprint(table.concat(t, \", \"))\r\nend\r\n\r\n--对治疗目标使用技能\r\nfunction CastX(szSkill)\r\n\tif xcast(szSkill, v[\"治疗目标\"]) then\r\n\t\tif v[\"记录信息\"] then PrintInfo() end\r\n\t\treturn true\r\n\tend\r\n\treturn false\r\nend\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>GBK
===================================================================
diff --git a/bin/assiant/Macro/万花/离经_ZC.lua b/bin/assiant/Macro/万花/离经_ZC.lua
--- a/bin/assiant/Macro/万花/离经_ZC.lua	(revision 7030c7ed4f1c896cb1226650b4a372b170bdce69)
+++ b/bin/assiant/Macro/万花/离经_ZC.lua	(date 1710519570000)
@@ -44,6 +44,7 @@
 	v["治疗目标血量"] = xlife(v["治疗目标"])
 	v["治疗目标是T"] = xmount("洗髓经|铁牢律|明尊琉璃体|铁骨衣", v["治疗目标"])
 
+	print(v["墨意"])
 	---------------------------------------------
 
 	--听风
@@ -51,6 +52,12 @@
 		CastX("听风吹雪")
 	end
 
+	if v["治疗目标血量"] < 0.8 then
+		if buff("412|722|932|3458|6266") then	--有瞬发
+			CastX("长针")
+		end
+	end
+
 	--长针
 	if v["治疗目标血量"] < 0.45 then
 		--水月
Index: bin/assiant/Macro/Lib_Base.lua
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>---\r\n--- Generated by EmmyLua(https://github.com/EmmyLua)\r\n--- Created by Gin.\r\n--- DateTime: 2024/1/16 9:25\r\n---\r\n\r\n\r\n--函数表\r\ng_base = {}\r\n\r\ng_base[\"采集\"] = function()\r\n    interact(doodad(\"名字:物资|止血草|河底的沙石|冰魂|浩气盟的物资|鱼篓|晶矿|马草|干柴|雪莲|铁血·犒赏\", \"距离<6\", \"距离最近\"))\r\n\r\n    if self().GetItemAmountInPackage(5, 4549) < 6 then\r\n        interact(doodad(\"名字:曼陀罗\", \"距离<6\", \"距离最近\"))\r\n    end\r\n\r\n    if self().GetItemAmountInPackage(5, 4550) < 6 then\r\n        interact(doodad(\"名字:黄杜鹃\", \"距离<6\", \"距离最近\"))\r\n    end\r\n\r\n    if self().GetItemAmountInPackage(5, 7925) < 20 then\r\n        if self().GetItemAmountInPackage(5, 7923) < 20 then\r\n            interact(doodad(\"名字:冰块\", \"距离<6\", \"距离最近\"))\r\n        end\r\n\r\n        if self().GetItemAmountInPackage(5, 7924) < 20 then\r\n            interact(doodad(\"名字:石灰粉\", \"距离<6\", \"距离最近\"))\r\n        end\r\n\r\n        use(5, 7923)\r\n    end\r\n\r\n    if self().GetItemAmountInPackage(5, 7920) < 20 then\r\n        interact(doodad(\"名字:发芽的土豆\", \"距离<6\", \"距离最近\"))\r\n    end\r\n\r\n    if self().GetItemAmountInPackage(5, 7922) < 10 then\r\n        interact(doodad(\"名字:发霉的饭菜\", \"距离<6\", \"距离最近\"))\r\n    end\r\nend\r\n\r\ng_base[\"酿酒打水\"] = function()\r\n    use(5, 35560)\r\n    --if self().GetItemAmountInPackage(5, 35524) < 250 then\r\n    --    use(5, 35560)\r\n    --end\r\n    --\r\n    --if self().GetItemAmountInPackage(5, 35525) < 250 then\r\n    --    use(5, 35560)\r\n    --end\r\n    --\r\n    --if self().GetItemAmountInPackage(5, 35523) < 250 then\r\n    --    use(5, 35560)\r\n    --end\r\nend\r\n\r\ng_base[\"切换目标\"] = function()\r\n    g_base[\"20尺内敌人\"] = npc(\"名字:重霄玄石矿|重霄玄石矿堆\", \"自己距离<20\", \"可选中\", \"自己可视\")\r\n    if g_base[\"20尺内敌人\"] ~= 0 then\r\n        settar(g_base[\"20尺内敌人\"])\r\n    end\r\nend\r\n\r\ng_base[\"切换目标6\"] = function()\r\n    g_base[\"6尺内敌人\"] = npc(\"名字:重霄玄石矿|重霄玄石矿堆\", \"自己距离<6\", \"可选中\", \"自己可视\")\r\n    if g_base[\"6尺内敌人\"] ~= 0 then\r\n        settar(g_base[\"6尺内敌人\"])\r\n    end\r\nend\r\n\r\ng_base[\"杀猪\"] = function()\r\n    if fight() then\r\n\r\n        return\r\n    end\r\n\r\n    if self().GetItemAmountInPackage(5, 7925) < 20 then\r\n        if self().GetItemAmountInPackage(5, 7923) < 20 then\r\n            interact(doodad(\"名字:冰块\", \"距离<6\", \"距离最近\"))\r\n        end\r\n\r\n        if self().GetItemAmountInPackage(5, 7924) < 20 then\r\n            interact(doodad(\"名字:石灰粉\", \"距离<6\", \"距离最近\"))\r\n        end\r\n\r\n        use(5, 7923)\r\n    end\r\n\r\n    if self().GetItemAmountInPackage(5, 7920) < 20 then\r\n        interact(doodad(\"名字:发芽的土豆\", \"距离<6\", \"距离最近\"))\r\n    end\r\n\r\n    if self().GetItemAmountInPackage(5, 7922) < 10 then\r\n        interact(doodad(\"名字:发霉的饭菜\", \"距离<6\", \"距离最近\"))\r\n    end\r\nend\r\n\r\nlocal castTable = {\r\n\r\n}\r\n\r\ncastTable[\"剑出鸿蒙\"] = function()\r\n    cast(23969)\r\nend\r\n\r\ncastTable[\"无方行尽\"] = function()\r\n    if tbuffstate(\"可锁足\") and qidian() > 9 then\r\n        cast(2674)\r\n    end\r\nend\r\n\r\ncastTable[\"万世不竭_二段\"] = function()\r\n    if qjcount() == 5 then\r\n        cast(18654)\r\n    end\r\nend\r\n\r\ncastTable[\"凭虚御风\"] = function()\r\n    if buff(\"生太极\") and dis() > 0 and dis() < 9 then\r\n        cast(\"凭虚御风\")\r\n    end\r\nend\r\n\r\ncastTable[\"三才化生\"] = function()\r\n    if dis() > 0 and dis() < 9 then\r\n        cast(\"三才化生\")\r\n    end\r\nend\r\n\r\n\r\ncastTable[\"八卦洞玄\"] = function()\r\n    if buff(\"会神\")  and qidian() > 9 and tbuffstate(\"可封内\") then\r\n        cast(\"八卦洞玄\")\r\n    end\r\nend\r\n\r\ng_base[\"气纯抓点\"] = function()\r\n    castTable[\"无方行尽\"]()\r\n    castTable[\"八卦洞玄\"]()\r\n\r\n    if tbuff(\"八卦洞玄\") then\r\n        if tbufftime(\"八卦洞玄\") < 0.2 then\r\n            castTable[\"万世不竭_二段\"]()\r\n            if qidian() > 7 then\r\n                cast(\"两仪化形\")\r\n            end\r\n\r\n            cast(\"九转归一\")\r\n            cast(\"太极无极\")\r\n        end\r\n\r\n        if nobuff(\"紫气东来\") and qidian() < 8 then\r\n            cast(\"紫气东来\")\r\n        end\r\n\r\n\r\n        if tbufftime(\"八卦洞玄\") < 2.7 then\r\n            castTable[\"剑出鸿蒙\"]()\r\n        end\r\n\r\n        if tbufftime(\"八卦洞玄\") < 2 then\r\n            castTable[\"万世不竭_二段\"]()\r\n        end\r\n\r\n        castTable[\"凭虚御风\"]()\r\n        castTable[\"三才化生\"]()\r\n\r\n        if qidian() > 8 then\r\n            cast(\"两仪化形\")\r\n        end\r\n    end\r\n\r\n    if tnobuff(\"八卦洞玄\") and tlife() < 0.3 then\r\n        castTable[\"万世不竭_二段\"]()\r\n        if qidian() > 7 then\r\n            cast(\"两仪化形\")\r\n        end\r\n        cast(\"太极无极\")\r\n        cast(\"九转归一\")\r\n    end\r\nend\r\n\r\nlocal g_control = {\r\n    killed = 100,\r\n    max = 100;\r\n\r\n    increment = function(self)\r\n        self.killed = self.killed + 1\r\n    end,\r\n\r\n    start = function(self)\r\n        self.killed = 0\r\n    end,\r\n\r\n    stop = function(self)\r\n        self.killed = self.max\r\n    end,\r\n\r\n    running = function(self)\r\n        self.killed = self.killed + 1\r\n        return self.killed <= self.max\r\n    end\r\n}\r\n\r\ng_base[\"指定心法\"] = function(name)\r\n    return xmountname(tid) == name\r\nend\r\n\r\ng_base[\"心法名称\"] = function()\r\n    return xmountname(tid)\r\nend\r\n\r\ng_base[\"瑞氛\"] = function()\r\n    if tbuffstate(\"可打断\") and tbuffstate(\"可眩晕\") then\r\n        if cntime(\"剑飞惊天\") == 0 and cntime(\"剑冲阴阳\") == 0 then\r\n            g_control[\"紫气东来\"] = cn(\"紫气东来\")\r\n            if (tlife() > 0.9 and g_control[\"紫气东来\"] > 2) or (tlife() < 0.8 and g_control[\"紫气东来\"] > 1) or (tlife() < 0.6 and g_control[\"紫气东来\"] > 0) then\r\n                g_control:increment()\r\n            end\r\n            g_control:start()\r\n        end\r\n    end\r\n\r\n    if g_control:running() then\r\n        cast(\"剑飞惊天\")\r\n        if(cntime(\"剑飞惊天\") == 0) then\r\n            return\r\n        end\r\n        cast(\"剑冲阴阳\")\r\n        if (cntime(\"剑冲阴阳\") == 0) then\r\n            return\r\n        end\r\n        moveto(xpos())\r\n\r\n        if cn(\"紫气东来\") > 0 then\r\n            cast(\"紫气东来\")\r\n        end\r\n\r\n        if qidian() > 8 then\r\n            cast(\"无我无剑\")\r\n        end\r\n\r\n        if tlife() < 0.4 then\r\n            cast(\"八荒归元\")\r\n        end\r\n    end\r\nend
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>GBK
===================================================================
diff --git a/bin/assiant/Macro/Lib_Base.lua b/bin/assiant/Macro/Lib_Base.lua
--- a/bin/assiant/Macro/Lib_Base.lua	(revision 7030c7ed4f1c896cb1226650b4a372b170bdce69)
+++ b/bin/assiant/Macro/Lib_Base.lua	(date 1710350796000)
@@ -181,6 +181,11 @@
     end
 end
 
+g_base["kill"] = function()
+    if qjcount() == 5 and bufftime("气剑") > 3 then
+
+    end
+end
 local g_control = {
     killed = 100,
     max = 100;
@@ -215,23 +220,25 @@
     if tbuffstate("可打断") and tbuffstate("可眩晕") then
         if cntime("剑飞惊天") == 0 and cntime("剑冲阴阳") == 0 then
             g_control["紫气东来"] = cn("紫气东来")
+            print(tlife())
+            print(g_control["紫气东来"])
             if (tlife() > 0.9 and g_control["紫气东来"] > 2) or (tlife() < 0.8 and g_control["紫气东来"] > 1) or (tlife() < 0.6 and g_control["紫气东来"] > 0) then
-                g_control:increment()
-            end
-            g_control:start()
+                g_control:start()
+            end
         end
     end
 
     if g_control:running() then
         cast("剑飞惊天")
-        if(cntime("剑飞惊天") == 0) then
+        if(scdtime("剑飞惊天") == 0) then
             return
         end
         cast("剑冲阴阳")
-        if (cntime("剑冲阴阳") == 0) then
+        --cast(2690)
+        if (scdtime("剑冲阴阳") == 0) then
             return
         end
-        moveto(xpos())
+        moveto(xpos(tid()))
 
         if cn("紫气东来") > 0 then
             cast("紫气东来")
